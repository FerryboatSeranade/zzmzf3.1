<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>配置管理</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="__STATIC__/lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="__STATIC__/css/public.css" media="all">
    <style>
        body {
            background-color: #ffffff;
        }
    </style>
</head>

<body>
    <div class="layuimini-container">
        <div class="layuimini-main" id="app">

            <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
                <ul class="layui-tab-title">
                    <li class="layui-this">网站设置</li>
                    <li>邮箱设置</li>
                    <li>通道设置</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">
                        <form id="app-form" class="layui-form layuimini-form">

                            <div class="layui-form-item">
                                <label class="layui-form-label required">网站链接</label>
                                <div class="layui-input-block">
                                    <input type="text" name="url" lay-verify="required" placeholder="请输入网站描述" value="{$url}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label required">网站标题</label>
                                <div class="layui-input-block">
                                    <input type="text" name="title" lay-verify="required" placeholder="请输入网站标题" value="{$title}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">网站关键词</label>
                                <div class="layui-input-block">
                                    <input type="text" name="keywords" placeholder="请输入网站关键词" value="{$keywords}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">网站描述</label>
                                <div class="layui-input-block">
                                    <input type="text" name="description" placeholder="请输入网站描述" value="{$description}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">网站底部</label>
                                <div class="layui-input-block">
                                    <input type="text" name="footer" placeholder="请输入网站底部" value="{$footer}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">手机号</label>
                                <div class="layui-input-block">
                                    <input type="text" name="phone" placeholder="请输入手机号" value="{$phone}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">QQ号</label>
                                <div class="layui-input-block">
                                    <input type="text" name="qq" placeholder="请输入QQ号" value="{$qq}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">微信号</label>
                                <div class="layui-input-block">
                                    <input type="text" name="weixin" placeholder="请输入微信号" value="{$weixin}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">邮箱</label>
                                <div class="layui-input-block">
                                    <input type="text" name="email" placeholder="请输入邮箱" value="{$email}" class="layui-input">
                                    <tip>设置了邮箱才会接收到通知！</tip>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">监控密钥</label>
                                <div class="layui-input-block">
                                    <input type="text" name="cron_key" placeholder="请输入监控密钥" value="{$cron_key}" class="layui-input">
                                    <tip>定时任务里的key，不是监控端的密钥，监控端是商户密钥，请注意！</tip>
                                </div>
                            </div>

                            <div class="hr-line"></div>
                            <div class="layui-form-item text-center">
                                <div class="layui-input-block">
                                    <button class="layui-btn layui-btn-normal" lay-submit lay-filter="saveBtn">确认保存</button>
                                </div>
                            </div>

                        </form>
                    </div>

                    <div class="layui-tab-item">
                        <form id="app-form" class="layui-form layuimini-form">
                            <input type="hidden" name="e_status" value="{$e_status}">
                            <div class="layui-form-item">
                                <label class="layui-form-label required">状态</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="e_status" {if $e_status == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">邮件编码</label>
                                <div class="layui-input-block">
                                    <select name="e_char_set">
                                        <option value="utf-8" {if $e_char_set === 'utf-8'}selected{/if}>utf-8</option>
                                        <option value="8bit" {if $e_char_set === '8bit'}selected{/if}>8bit</option>
                                        <option value="7bit" {if $e_char_set === '7bit'}selected{/if}>7bit</option>
                                        <option value="binary" {if $e_char_set === 'binary'}selected{/if}>binary</option>
                                        <option value="base64" {if $e_char_set === 'base64'}selected{/if}>base64</option>
                                        <option value="quoted-printable" {if $e_char_set === 'quoted-printable'}selected{/if}>quoted-printable</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">SMTP 端口</label>
                                <div class="layui-input-block">
                                    <input type="text" name="e_port" placeholder="请输入SMTP 端口" value="{$e_port}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">SMTP 主机名</label>
                                <div class="layui-input-block">
                                    <input type="text" name="e_host" placeholder="请输入SMTP 主机名" value="{$e_host}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">SMTP 用户名</label>
                                <div class="layui-input-block">
                                    <input type="text" name="e_username" placeholder="请输入SMTP 用户名" value="{$e_username}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">SMTP 密码</label>
                                <div class="layui-input-block">
                                    <input type="password" name="e_password" placeholder="请输入SMTP 密码" value="{$e_password}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">SMTP SSL类型</label>
                                <div class="layui-input-block">
                                    <select name="e_smtp_secure">
                                        <option value="">无</option>
                                        <option value="ssl" selected>ssl</option>
                                        <option value="tls">tls</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">系统邮件名</label>
                                <div class="layui-input-block">
                                    <input type="text" name="e_from_name" placeholder="请输入系统邮件名" value="{$e_from_name}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">系统邮箱名</label>
                                <div class="layui-input-block">
                                    <input type="text" name="e_set_from" placeholder="请输入系统邮箱名" value="{$e_set_from}" class="layui-input">
                                </div>
                            </div>

                            <div class="hr-line"></div>
                            <div class="layui-form-item text-center">
                                <div class="layui-input-block">
                                    <button class="layui-btn layui-btn-normal" lay-submit lay-filter="saveBtn">确认保存</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="layui-tab-item">
                        <form id="app-form" class="layui-form layuimini-form">
                            <input type="hidden" name="voice" value="{$voice}">
                            <input type="hidden" name="offline" value="{$offline}">
                            <input type="hidden" name="popup" value="{$popup}">
                            <input type="hidden" name="mail_login" value="{$mail_login}">
                            <input type="hidden" name="mail_order" value="{$mail_order}">
                            <input type="hidden" name="mail_order_bd" value="{$mail_order_bd}">
                            <input type="hidden" name="confirm" value="{$confirm}">
                            <div class="layui-form-item">
                                <label class="layui-form-label">语音提醒</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="voice" {if $voice == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">语音提醒内容</label>
                                <div class="layui-input-block">
                                    <input type="text" name="voice_text" placeholder="请输入语音提醒内容" value="{$voice_text}" class="layui-input">
                                    <tip>语音提醒内容，{money}是金额</tip>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">掉线提醒</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="offline" {if $offline == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">付款弹窗提示</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="popup" {if $popup == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">付款弹窗内容</label>
                                <div class="layui-input-block">
                                    <input type="text" name="prompt" placeholder="请输入付款弹窗内容" value="{$prompt}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">邮件登录提示</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="mail_login" {if $mail_login == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">订单消息通知</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="mail_order" {if $mail_order == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">订单补单通知</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="mail_order_bd" {if $mail_order_bd == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">支付宝确认页</label>
                                <div class="layui-input-block">
                                    <input type="checkbox" lay-skin="switch" lay-text="开启|禁用" lay-filter="confirm" {if $confirm == 1}checked{/if}>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">收银模板</label>
                                <div class="layui-input-block">
                                    <select name="formwork">
                                        <option value="1" {if $formwork == 1}selected{/if}>模板一</option>
                                        <option value="2" {if $formwork == 2}selected{/if}>模板二</option>
                                        <option value="3" {if $formwork == 3}selected{/if}>模板三</option>
                                        <option value="4" {if $formwork == 4}selected{/if}>模板四</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">订单超时时间</label>
                                <div class="layui-input-block">
                                    <input type="number" name="order_timeout" placeholder="请输入订单超时时间，单位：分" value="{$order_timeout}" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">超时跳转地址</label>
                                <div class="layui-input-block">
                                    <input type="text" name="timeout_url" placeholder="请输入超时跳转地址" value="{$timeout_url}" class="layui-input">
                                </div>
                            </div>

                            <div class="hr-line"></div>
                            <div class="layui-form-item text-center">
                                <div class="layui-input-block">
                                    <button class="layui-btn layui-btn-normal" lay-submit lay-filter="saveBtn">确认保存</button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
            </div>

        </div>
    </div>

    <script src="__STATIC__/lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
    <script>
        layui.use(['form'], function () {
            var form = layui.form,
                layer = layui.layer,
                $ = layui.$;

            //监听提交
            form.on('submit(saveBtn)', function (data) {
                $.post("{:url('system.config/edit')}", data.field, function (res) {
                    icon = res.code == 1 ? 1 : 2;
                    layer.msg(res.msg, { time: 1500, icon: icon }, function () {
                        if (res.code == 1) {
                            location.reload();
                        }
                    })
                })

                return false;
            });

            // 监听状态事件
            form.on('switch(e_status)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="e_status"]').val(status);
            });
            form.on('switch(voice)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="voice"]').val(status);
            });
            form.on('switch(offline)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="offline"]').val(status);
            });
            form.on('switch(popup)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="popup"]').val(status);
            });
            form.on('switch(mail_login)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="mail_login"]').val(status);
            });
            form.on('switch(mail_order)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="mail_order"]').val(status);
            });
            form.on('switch(mail_order_bd)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="mail_order_bd"]').val(status);
            });
            form.on('switch(confirm)', function(obj) {
                // console.log(obj);
                // layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
                var status = obj.elem.checked ? 1 : 0;
                $('[name="confirm"]').val(status);
            });

        });
    </script>
</body>

</html>